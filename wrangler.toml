# Kodepos API Indonesia - Cloudflare Workers Configuration
# High-performance Indonesian postal code API with 83,761 records
# Author: Maxwell Alpha - https://github.com/mxwllalpha - mxwllalpha@gmail.com

name = "kodepos-worker"
main = "src/index.ts"
compatibility_date = "2024-11-03"
compatibility_flags = ["nodejs_compat_v2"]

# Auto-provisioned D1 Database for postal code data
# This database will be automatically created during deployment
# [[d1_databases]]
# binding = "KODEPOS_DB"
# database_name = "kodepos-db"
# database_id will be auto-assigned by Cloudflare during deployment

# Environment Variables
[vars]
ENVIRONMENT = "production"
API_VERSION = "v1"
DATA_SOURCE_VERSION = "2025-11-26"

# Staging Environment for testing
[env.staging]
name = "kodepos-worker-staging"

[[env.staging.d1_databases]]
binding = "KODEPOS_DB"
database_name = "kodepos-db-staging"
# database_id will be auto-assigned by Cloudflare during deployment

[env.staging.vars]
ENVIRONMENT = "staging"

# Production Environment
[env.production]
name = "kodepos-api"

[[env.production.d1_databases]]
binding = "KODEPOS_DB"
database_name = "kodepos-db"
# database_id will be auto-assigned by Cloudflare during deployment

[env.production.vars]
ENVIRONMENT = "production"

# Build Configuration
[build]
watch_dir = "src"

# Observability
[observability]
enabled = true